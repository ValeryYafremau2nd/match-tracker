"use strict";(self.webpackChunkfootball_reminder=self.webpackChunkfootball_reminder||[]).push([[638],{1638:(te,P,u)=>{u.r(P),u.d(P,{AuthModule:()=>q});var g=u(9808),d=u(3075),v=u(1553),w=u(655),m=u(8379),A=u(591),t=u(5e3),_=u(9351);let S=(()=>{class s{constructor(e,i){this.route=e,this.store=i,this.mode$=new A.X(this.route.snapshot.params.mode),this.modeSub=this.route.params.subscribe(o=>this.mode$.next(o.mode))}ngOnDestroy(){this.modeSub.unsubscribe()}login(e,i){this.store.dispatch(new m.m3({email:e,password:i}))}loginOauth(e,i){this.store.dispatch(new m.vp({user:e,token:i}))}logout(){this.store.dispatch(new m.y3)}signup(e,i){this.store.dispatch(new m.Mo({email:e,password:i}))}}return s.\u0275fac=function(e){return new(e||s)(t.LFG(v.gz),t.LFG(_.yh))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var T=u(8929),y=u(341),I=u(2654),E=u(7770),N=u(5279),U=u(5283);class b extends T.xQ{constructor(n=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,i){super(),this.scheduler=i,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=n<1?1:n,this._windowTime=e<1?1:e,e===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(n){const e=this._events;e.push(n),e.length>this._bufferSize&&e.shift(),super.next(n)}nextTimeWindow(n){this._events.push(new D(this._getNow(),n)),this._trimBufferThenGetEvents(),super.next(n)}_subscribe(n){const e=this._infiniteTimeWindow,i=e?this._events:this._trimBufferThenGetEvents(),o=this.scheduler,a=i.length;let r;if(this.closed)throw new N.N;if(this.isStopped||this.hasError?r=I.w.EMPTY:(this.observers.push(n),r=new U.W(this,n)),o&&n.add(n=new E.ht(n,o)),e)for(let l=0;l<a&&!n.closed;l++)n.next(i[l]);else for(let l=0;l<a&&!n.closed;l++)n.next(i[l].value);return this.hasError?n.error(this.thrownError):this.isStopped&&n.complete(),r}_getNow(){return(this.scheduler||y.c).now()}_trimBufferThenGetEvents(){const n=this._getNow(),e=this._bufferSize,i=this._windowTime,o=this._events,a=o.length;let r=0;for(;r<a&&!(n-o[r].time<i);)r++;return a>e&&(r=Math.max(r,a-e)),r>0&&o.splice(0,r),o}}class D{constructor(n,e){this.time=n,this.value=e}}class k extends T.xQ{constructor(){super(...arguments),this.value=null,this.hasNext=!1,this.hasCompleted=!1}_subscribe(n){return this.hasError?(n.error(this.thrownError),I.w.EMPTY):this.hasCompleted&&this.hasNext?(n.next(this.value),n.complete(),I.w.EMPTY):super._subscribe(n)}next(n){this.hasCompleted||(this.value=n,this.hasNext=!0)}error(n){this.hasCompleted||super.error(n)}complete(){this.hasCompleted=!0,this.hasNext&&super.next(this.value),super.complete()}}class L{}let f=(()=>{class s extends class M{constructor(){}loadScript(n,e,i,o=null){if("undefined"!=typeof document&&!document.getElementById(n)){let a=document.createElement("script");a.async=!0,a.src=e,a.onload=i,o||(o=document.head),o.appendChild(a)}}}{constructor(e,i={scope:"email"}){super(),this.clientId=e,this.initOptions=i}initialize(){return new Promise((e,i)=>{try{this.loadScript(s.PROVIDER_ID,"https://apis.google.com/js/platform.js",()=>{gapi.load("auth2",()=>{this.auth2=gapi.auth2.init(Object.assign(Object.assign({},this.initOptions),{client_id:this.clientId})),this.auth2.then(()=>{e()}).catch(o=>{i(o)})})})}catch(o){i(o)}})}getLoginStatus(e){const i=Object.assign(Object.assign({},this.initOptions),e);return new Promise((o,a)=>{if(this.auth2.isSignedIn.get()){let r=new L;const l=this.auth2.currentUser.get().getBasicProfile(),h=this.auth2.currentUser.get().getAuthResponse(!0);r.id=l.getId(),r.name=l.getName(),r.email=l.getEmail(),r.photoUrl=l.getImageUrl(),r.firstName=l.getGivenName(),r.lastName=l.getFamilyName(),r.response=h;const c=p=>{r.authToken=p.access_token,r.idToken=p.id_token,o(r)};i.refreshToken?this.auth2.currentUser.get().reloadAuthResponse().then(c):c(this.auth2.currentUser.get().getAuthResponse(!0))}else a(`No user is currently logged in with ${s.PROVIDER_ID}`)})}signIn(e){const i=Object.assign(Object.assign({},this.initOptions),e);return new Promise((o,a)=>{(i&&i.offline_access?this.auth2.grantOfflineAccess(e):this.auth2.signIn(e)).then(h=>{let c=new L;if(h&&h.code)c.authorizationCode=h.code;else{let p=this.auth2.currentUser.get().getBasicProfile(),R=this.auth2.currentUser.get().getAuthResponse(!0),X=R.access_token,ee=R.id_token;c.id=p.getId(),c.name=p.getName(),c.email=p.getEmail(),c.photoUrl=p.getImageUrl(),c.firstName=p.getGivenName(),c.lastName=p.getFamilyName(),c.authToken=X,c.idToken=ee,c.response=R}o(c)},h=>{a(h)}).catch(h=>{a(h)})})}signOut(e){return new Promise((i,o)=>{let a;a=e?this.auth2.disconnect():this.auth2.signOut(),a.then(r=>{r?o(r):i()}).catch(r=>{o(r)})})}}return s.PROVIDER_ID="GOOGLE",s})(),O=(()=>{class s{constructor(e){this.providers=new Map,this.autoLogin=!1,this._user=null,this._authState=new b(1),this.initialized=!1,this._initState=new k,e instanceof Promise?e.then(i=>{this.initialize(i)}):this.initialize(e)}get authState(){return this._authState.asObservable()}get initState(){return this._initState.asObservable()}initialize(e){this.autoLogin=void 0!==e.autoLogin&&e.autoLogin;const{onError:i=console.error}=e;e.providers.forEach(o=>{this.providers.set(o.id,o.provider)}),Promise.all(Array.from(this.providers.values()).map(o=>o.initialize())).then(()=>{if(this.autoLogin){const o=[];let a=!1;this.providers.forEach((r,l)=>{let h=r.getLoginStatus();o.push(h),h.then(c=>{c.provider=l,this._user=c,this._authState.next(c),a=!0}).catch(console.debug)}),Promise.all(o).catch(()=>{a||(this._user=null,this._authState.next(null))})}}).catch(o=>{i(o)}).finally(()=>{this.initialized=!0,this._initState.next(this.initialized),this._initState.complete()})}refreshAuthToken(e){return new Promise((i,o)=>{if(this.initialized)if(e!==f.PROVIDER_ID)o(s.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN);else{const a=this.providers.get(e);a?a.getLoginStatus({refreshToken:!0}).then(r=>{r.provider=e,this._user=r,this._authState.next(r),i()}).catch(r=>{o(r)}):o(s.ERR_LOGIN_PROVIDER_NOT_FOUND)}else o(s.ERR_NOT_INITIALIZED)})}signIn(e,i){return new Promise((o,a)=>{if(this.initialized){let r=this.providers.get(e);r?r.signIn(i).then(l=>{l.provider=e,o(l),this._user=l,this._authState.next(l)}).catch(l=>{a(l)}):a(s.ERR_LOGIN_PROVIDER_NOT_FOUND)}else a(s.ERR_NOT_INITIALIZED)})}signOut(e=!1){return new Promise((i,o)=>{if(this.initialized)if(this._user){let r=this.providers.get(this._user.provider);r?r.signOut(e).then(()=>{i(),this._user=null,this._authState.next(null)}).catch(l=>{o(l)}):o(s.ERR_LOGIN_PROVIDER_NOT_FOUND)}else o(s.ERR_NOT_LOGGED_IN);else o(s.ERR_NOT_INITIALIZED)})}}return s.ERR_LOGIN_PROVIDER_NOT_FOUND="Login provider not found",s.ERR_NOT_LOGGED_IN="Not logged in",s.ERR_NOT_INITIALIZED="Login providers not ready yet. Are there errors on your console?",s.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN="Chosen login provider is not supported for refreshing a token",s.\u0275fac=function(e){return new(e||s)(t.LFG("SocialAuthServiceConfig"))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac}),s})(),x=(()=>{class s{constructor(e){if(e)throw new Error("SocialLoginModule is already loaded. Import it in the AppModule only")}static initialize(e){return{ngModule:s,providers:[O,{provide:"SocialAuthServiceConfig",useValue:e}]}}}return s.\u0275fac=function(e){return new(e||s)(t.LFG(s,12))},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({providers:[O],imports:[[g.ez]]}),s})();function j(s,n){if(1&s&&(t.TgZ(0,"div",11),t._uU(1),t.qZA()),2&s){const e=t.oxw();t.xp6(1),t.Oqu(e.error)}}function C(s,n){1&s&&(t.TgZ(0,"div",4),t._UZ(1,"input",12),t.qZA())}function z(s,n){if(1&s){const e=t.EpF();t.TgZ(0,"div")(1,"button",13),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(),a=t.MAs(3);return o.login(a)}),t._uU(2," Sign In "),t.qZA(),t.TgZ(3,"button",14),t._uU(4," Sign Up "),t.qZA()()}2&s&&(t.xp6(3),t.Q6J("routerLink","/auth/signup"))}function V(s,n){if(1&s){const e=t.EpF();t.TgZ(0,"div")(1,"button",13),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(),a=t.MAs(3);return o.signup(a)}),t._uU(2," Sign Up "),t.qZA(),t.TgZ(3,"button",14),t._uU(4," Sign In "),t.qZA()()}2&s&&(t.xp6(3),t.Q6J("routerLink","/auth/login"))}let F=(()=>{class s{constructor(e,i,o){this.store=e,this.socialAuthService=i,this.authService=o,this.isLoginMode=!0,this.error=""}ngOnInit(){this.modeSub=this.authService.mode$.subscribe(e=>this.mode=e),this.authService.logout(),this.store.select("auth").subscribe(e=>{this.error=e.error}),this.socialAuthService.authState.subscribe(e=>{this.socialUser=e,this.isLoggedin=null!=e,console.log(this.socialUser)})}ngOnDestroy(){this.modeSub.unsubscribe()}login(e){this.authService.login(e.form.controls.email.value,e.form.controls.password.value)}signup(e){this.authService.signup(e.form.controls.email.value,e.form.controls.password.value)}loginWithGoogle(){return(0,w.mG)(this,void 0,void 0,function*(){const e=yield this.socialAuthService.signIn(f.PROVIDER_ID);this.authService.loginOauth(e.id,e.response.id_token)})}logOut(){this.socialAuthService.signOut()}onSwitchMode(){}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(_.yh),t.Y36(O),t.Y36(S))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-auth"]],features:[t._Bn([S])],decls:15,vars:5,consts:[[1,"auth-form"],[1,"col-xs-12","col-md-offset-3"],["authForm","ngForm"],["class","error",4,"ngIf"],[1,"form-group"],["type","email","id","email","ngModel","","placeholder","Email","name","email","required","","email","",1,"form-control"],["type","password","id","password","ngModel","","name","password","placeholder","Password","required","","minlength","6",1,"form-control"],["class","form-group",4,"ngIf"],["type","button",1,"btn","btn-primary",2,"float","left","margin-right","10px",3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"error"],["type","password","id","confirmPassword","ngModel","","name","password","placeholder","Confirm password","required","","minlength","6",1,"form-control"],["type","submit",1,"btn","btn-success",3,"click"],[1,"btn","btn-link",3,"routerLink"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"form",null,2),t.YNc(4,j,2,1,"div",3),t.TgZ(5,"div",4),t._UZ(6,"input",5),t.qZA(),t.TgZ(7,"div",4),t._UZ(8,"input",6),t.qZA(),t.YNc(9,C,2,0,"div",7),t.TgZ(10,"button",8),t.NdJ("click",function(){return i.loginWithGoogle()}),t._uU(11,"Google OAuth"),t.qZA(),t.TgZ(12,"div",9),t.YNc(13,z,5,1,"div",10),t.YNc(14,V,5,1,"div",10),t.qZA()()()()),2&e&&(t.xp6(4),t.Q6J("ngIf",i.error),t.xp6(5),t.Q6J("ngIf","signup"===i.mode),t.xp6(3),t.Q6J("ngSwitch",i.mode),t.xp6(1),t.Q6J("ngSwitchCase","login"),t.xp6(1),t.Q6J("ngSwitchCase","signup"))},directives:[d._Y,d.JL,d.F,g.O5,d.Fj,d.JJ,d.On,d.Q7,d.on,d.wO,g.RF,g.n9,v.rH],styles:[".auth-form[_ngcontent-%COMP%]{position:absolute;display:flex;height:80%;align-items:center;width:100%;justify-content:center}.auth-form[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border:2px solid lavender;border-radius:8px;padding:30px;width:355px}.error[_ngcontent-%COMP%]{border-radius:7px;background-color:pink;padding:2px 10px}"]}),s})();var Z=u(7423),G=u(9224),B=u(508),Y=u(5245),K=u(7531),J=u(2181),$=u(4107),W=u(2368),Q=u(3799),H=u(4594);let q=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({providers:[{provide:"SocialAuthServiceConfig",useValue:{autoLogin:!1,providers:[{id:f.PROVIDER_ID,provider:new f("124452340094-n9trtaie2urmc0n9ke9mca6urhh3djds.apps.googleusercontent.com")}]}}],imports:[[g.ez,d.u5,d.UX,x,v.Bz.forChild([{path:"",component:F}]),H.g0,K.c,G.QW,J.Tx,Y.Ps,Z.ot,Q.p0,W.rP,$.LD,B.Ng]]}),s})()}}]);