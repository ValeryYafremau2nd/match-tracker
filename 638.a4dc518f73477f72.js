"use strict";(self.webpackChunkfootball_reminder=self.webpackChunkfootball_reminder||[]).push([[638],{1638:(te,P,u)=>{u.r(P),u.d(P,{AuthModule:()=>q});var g=u(9808),d=u(3075),v=u(1553),w=u(655),m=u(8379),y=u(591),s=u(5e3),_=u(9351);let S=(()=>{class i{constructor(e,t){this.route=e,this.store=t,this.mode$=new y.X(this.route.snapshot.params.mode),this.modeSub=this.route.params.subscribe(o=>this.mode$.next(o.mode))}ngOnDestroy(){this.modeSub.unsubscribe()}login(e,t){this.store.dispatch(new m.m3({email:e,password:t}))}loginOauth(e,t){this.store.dispatch(new m.vp({user:e,token:t}))}logout(){this.store.dispatch(new m.y3)}signup(e,t){this.store.dispatch(new m.Mo({email:e,password:t}))}}return i.\u0275fac=function(e){return new(e||i)(s.LFG(v.gz),s.LFG(_.yh))},i.\u0275prov=s.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var T=u(8929),A=u(341),I=u(2654),E=u(7770),N=u(5279),U=u(5283);class b extends T.xQ{constructor(n=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,t){super(),this.scheduler=t,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=n<1?1:n,this._windowTime=e<1?1:e,e===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(n){const e=this._events;e.push(n),e.length>this._bufferSize&&e.shift(),super.next(n)}nextTimeWindow(n){this._events.push(new D(this._getNow(),n)),this._trimBufferThenGetEvents(),super.next(n)}_subscribe(n){const e=this._infiniteTimeWindow,t=e?this._events:this._trimBufferThenGetEvents(),o=this.scheduler,a=t.length;let r;if(this.closed)throw new N.N;if(this.isStopped||this.hasError?r=I.w.EMPTY:(this.observers.push(n),r=new U.W(this,n)),o&&n.add(n=new E.ht(n,o)),e)for(let l=0;l<a&&!n.closed;l++)n.next(t[l]);else for(let l=0;l<a&&!n.closed;l++)n.next(t[l].value);return this.hasError?n.error(this.thrownError):this.isStopped&&n.complete(),r}_getNow(){return(this.scheduler||A.c).now()}_trimBufferThenGetEvents(){const n=this._getNow(),e=this._bufferSize,t=this._windowTime,o=this._events,a=o.length;let r=0;for(;r<a&&!(n-o[r].time<t);)r++;return a>e&&(r=Math.max(r,a-e)),r>0&&o.splice(0,r),o}}class D{constructor(n,e){this.time=n,this.value=e}}class k extends T.xQ{constructor(){super(...arguments),this.value=null,this.hasNext=!1,this.hasCompleted=!1}_subscribe(n){return this.hasError?(n.error(this.thrownError),I.w.EMPTY):this.hasCompleted&&this.hasNext?(n.next(this.value),n.complete(),I.w.EMPTY):super._subscribe(n)}next(n){this.hasCompleted||(this.value=n,this.hasNext=!0)}error(n){this.hasCompleted||super.error(n)}complete(){this.hasCompleted=!0,this.hasNext&&super.next(this.value),super.complete()}}class L{}let f=(()=>{class i extends class M{constructor(){}loadScript(n,e,t,o=null){if("undefined"!=typeof document&&!document.getElementById(n)){let a=document.createElement("script");a.async=!0,a.src=e,a.onload=t,o||(o=document.head),o.appendChild(a)}}}{constructor(e,t={scope:"email"}){super(),this.clientId=e,this.initOptions=t}initialize(){return new Promise((e,t)=>{try{this.loadScript(i.PROVIDER_ID,"https://apis.google.com/js/platform.js",()=>{gapi.load("auth2",()=>{this.auth2=gapi.auth2.init(Object.assign(Object.assign({},this.initOptions),{client_id:this.clientId})),this.auth2.then(()=>{e()}).catch(o=>{t(o)})})})}catch(o){t(o)}})}getLoginStatus(e){const t=Object.assign(Object.assign({},this.initOptions),e);return new Promise((o,a)=>{if(this.auth2.isSignedIn.get()){let r=new L;const l=this.auth2.currentUser.get().getBasicProfile(),h=this.auth2.currentUser.get().getAuthResponse(!0);r.id=l.getId(),r.name=l.getName(),r.email=l.getEmail(),r.photoUrl=l.getImageUrl(),r.firstName=l.getGivenName(),r.lastName=l.getFamilyName(),r.response=h;const c=p=>{r.authToken=p.access_token,r.idToken=p.id_token,o(r)};t.refreshToken?this.auth2.currentUser.get().reloadAuthResponse().then(c):c(this.auth2.currentUser.get().getAuthResponse(!0))}else a(`No user is currently logged in with ${i.PROVIDER_ID}`)})}signIn(e){const t=Object.assign(Object.assign({},this.initOptions),e);return new Promise((o,a)=>{(t&&t.offline_access?this.auth2.grantOfflineAccess(e):this.auth2.signIn(e)).then(h=>{let c=new L;if(h&&h.code)c.authorizationCode=h.code;else{let p=this.auth2.currentUser.get().getBasicProfile(),R=this.auth2.currentUser.get().getAuthResponse(!0),X=R.access_token,ee=R.id_token;c.id=p.getId(),c.name=p.getName(),c.email=p.getEmail(),c.photoUrl=p.getImageUrl(),c.firstName=p.getGivenName(),c.lastName=p.getFamilyName(),c.authToken=X,c.idToken=ee,c.response=R}o(c)},h=>{a(h)}).catch(h=>{a(h)})})}signOut(e){return new Promise((t,o)=>{let a;a=e?this.auth2.disconnect():this.auth2.signOut(),a.then(r=>{r?o(r):t()}).catch(r=>{o(r)})})}}return i.PROVIDER_ID="GOOGLE",i})(),O=(()=>{class i{constructor(e){this.providers=new Map,this.autoLogin=!1,this._user=null,this._authState=new b(1),this.initialized=!1,this._initState=new k,e instanceof Promise?e.then(t=>{this.initialize(t)}):this.initialize(e)}get authState(){return this._authState.asObservable()}get initState(){return this._initState.asObservable()}initialize(e){this.autoLogin=void 0!==e.autoLogin&&e.autoLogin;const{onError:t=console.error}=e;e.providers.forEach(o=>{this.providers.set(o.id,o.provider)}),Promise.all(Array.from(this.providers.values()).map(o=>o.initialize())).then(()=>{if(this.autoLogin){const o=[];let a=!1;this.providers.forEach((r,l)=>{let h=r.getLoginStatus();o.push(h),h.then(c=>{c.provider=l,this._user=c,this._authState.next(c),a=!0}).catch(console.debug)}),Promise.all(o).catch(()=>{a||(this._user=null,this._authState.next(null))})}}).catch(o=>{t(o)}).finally(()=>{this.initialized=!0,this._initState.next(this.initialized),this._initState.complete()})}refreshAuthToken(e){return new Promise((t,o)=>{if(this.initialized)if(e!==f.PROVIDER_ID)o(i.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN);else{const a=this.providers.get(e);a?a.getLoginStatus({refreshToken:!0}).then(r=>{r.provider=e,this._user=r,this._authState.next(r),t()}).catch(r=>{o(r)}):o(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}else o(i.ERR_NOT_INITIALIZED)})}signIn(e,t){return new Promise((o,a)=>{if(this.initialized){let r=this.providers.get(e);r?r.signIn(t).then(l=>{l.provider=e,o(l),this._user=l,this._authState.next(l)}).catch(l=>{a(l)}):a(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}else a(i.ERR_NOT_INITIALIZED)})}signOut(e=!1){return new Promise((t,o)=>{if(this.initialized)if(this._user){let r=this.providers.get(this._user.provider);r?r.signOut(e).then(()=>{t(),this._user=null,this._authState.next(null)}).catch(l=>{o(l)}):o(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}else o(i.ERR_NOT_LOGGED_IN);else o(i.ERR_NOT_INITIALIZED)})}}return i.ERR_LOGIN_PROVIDER_NOT_FOUND="Login provider not found",i.ERR_NOT_LOGGED_IN="Not logged in",i.ERR_NOT_INITIALIZED="Login providers not ready yet. Are there errors on your console?",i.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN="Chosen login provider is not supported for refreshing a token",i.\u0275fac=function(e){return new(e||i)(s.LFG("SocialAuthServiceConfig"))},i.\u0275prov=s.Yz7({token:i,factory:i.\u0275fac}),i})(),x=(()=>{class i{constructor(e){if(e)throw new Error("SocialLoginModule is already loaded. Import it in the AppModule only")}static initialize(e){return{ngModule:i,providers:[O,{provide:"SocialAuthServiceConfig",useValue:e}]}}}return i.\u0275fac=function(e){return new(e||i)(s.LFG(i,12))},i.\u0275mod=s.oAB({type:i}),i.\u0275inj=s.cJS({providers:[O],imports:[[g.ez]]}),i})();function j(i,n){if(1&i&&(s.TgZ(0,"div",11),s._uU(1),s.qZA()),2&i){const e=s.oxw();s.xp6(1),s.Oqu(e.error)}}function C(i,n){1&i&&(s.TgZ(0,"div",4),s._UZ(1,"input",12),s.qZA())}function z(i,n){if(1&i){const e=s.EpF();s.TgZ(0,"div")(1,"button",13),s.NdJ("click",function(){s.CHM(e);const o=s.oxw(),a=s.MAs(3);return o.login(a)}),s._uU(2," Sign In "),s.qZA(),s.TgZ(3,"button",14),s._uU(4," Sign Up "),s.qZA()()}2&i&&(s.xp6(3),s.Q6J("routerLink","/auth/signup"))}function V(i,n){if(1&i){const e=s.EpF();s.TgZ(0,"div")(1,"button",13),s.NdJ("click",function(){s.CHM(e);const o=s.oxw(),a=s.MAs(3);return o.signup(a)}),s._uU(2," Sign Up "),s.qZA(),s.TgZ(3,"button",14),s._uU(4," Sign In "),s.qZA()()}2&i&&(s.xp6(3),s.Q6J("routerLink","/auth/login"))}let F=(()=>{class i{constructor(e,t,o){this.store=e,this.socialAuthService=t,this.authService=o,this.isLoginMode=!0,this.error=""}ngOnInit(){this.modeSub=this.authService.mode$.subscribe(e=>this.mode=e),this.authService.logout(),this.store.select("auth").subscribe(e=>{this.error=e.error}),this.socialAuthService.authState.subscribe(e=>{this.socialUser=e,this.isLoggedin=null!=e,console.log(this.socialUser)})}ngOnDestroy(){this.modeSub.unsubscribe()}login(e){this.authService.login(e.form.controls.email.value,e.form.controls.password.value)}signup(e){const t=e.form.controls;t.confirmPassword.value!==t.password.value?this.error="Password confirmed incorrectly.":this.authService.signup(e.form.controls.email.value,e.form.controls.password.value)}loginWithGoogle(){return(0,w.mG)(this,void 0,void 0,function*(){const e=yield this.socialAuthService.signIn(f.PROVIDER_ID);this.authService.loginOauth(e.id,e.response.id_token)})}logOut(){this.socialAuthService.signOut()}onSwitchMode(){}}return i.\u0275fac=function(e){return new(e||i)(s.Y36(_.yh),s.Y36(O),s.Y36(S))},i.\u0275cmp=s.Xpm({type:i,selectors:[["app-auth"]],features:[s._Bn([S])],decls:15,vars:5,consts:[[1,"auth-form"],[1,"col-xs-12","col-md-offset-3"],["authForm","ngForm"],["class","error",4,"ngIf"],[1,"form-group"],["type","email","id","email","ngModel","","placeholder","Email","name","email","required","","email","",1,"form-control"],["type","password","id","password","ngModel","","name","password","placeholder","Password","required","","minlength","6",1,"form-control"],["class","form-group",4,"ngIf"],["type","button",1,"btn","btn-primary",2,"float","left","margin-right","10px",3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"error"],["type","password","id","confirmPassword","ngModel","","name","confirmPassword","placeholder","Confirm password","required","","minlength","6",1,"form-control"],["type","submit",1,"btn","btn-success",3,"click"],[1,"btn","btn-link",3,"routerLink"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0)(1,"div",1)(2,"form",null,2),s.YNc(4,j,2,1,"div",3),s.TgZ(5,"div",4),s._UZ(6,"input",5),s.qZA(),s.TgZ(7,"div",4),s._UZ(8,"input",6),s.qZA(),s.YNc(9,C,2,0,"div",7),s.TgZ(10,"button",8),s.NdJ("click",function(){return t.loginWithGoogle()}),s._uU(11,"Google OAuth"),s.qZA(),s.TgZ(12,"div",9),s.YNc(13,z,5,1,"div",10),s.YNc(14,V,5,1,"div",10),s.qZA()()()()),2&e&&(s.xp6(4),s.Q6J("ngIf",t.error),s.xp6(5),s.Q6J("ngIf","signup"===t.mode),s.xp6(3),s.Q6J("ngSwitch",t.mode),s.xp6(1),s.Q6J("ngSwitchCase","login"),s.xp6(1),s.Q6J("ngSwitchCase","signup"))},directives:[d._Y,d.JL,d.F,g.O5,d.Fj,d.JJ,d.On,d.Q7,d.on,d.wO,g.RF,g.n9,v.rH],styles:[".auth-form[_ngcontent-%COMP%]{position:absolute;display:flex;height:80%;align-items:center;width:100%;justify-content:center}.auth-form[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border:2px solid lavender;border-radius:8px;padding:30px;width:355px}.error[_ngcontent-%COMP%]{border-radius:7px;background-color:pink;padding:2px 10px}"]}),i})();var Z=u(7423),G=u(9224),B=u(508),Y=u(5245),K=u(7531),J=u(2181),$=u(4107),W=u(2368),Q=u(3799),H=u(4594);let q=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=s.oAB({type:i}),i.\u0275inj=s.cJS({providers:[{provide:"SocialAuthServiceConfig",useValue:{autoLogin:!1,providers:[{id:f.PROVIDER_ID,provider:new f("124452340094-n9trtaie2urmc0n9ke9mca6urhh3djds.apps.googleusercontent.com")}]}}],imports:[[g.ez,d.u5,d.UX,x,v.Bz.forChild([{path:"",component:F}]),H.g0,K.c,G.QW,J.Tx,Y.Ps,Z.ot,Q.p0,W.rP,$.LD,B.Ng]]}),i})()}}]);